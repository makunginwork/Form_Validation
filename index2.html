<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ฟอร์มแบบสอบถามสุขภาพ</title>

</head>
<body>
    <h2>ฟอร์มแบบสอบถามสุขภาพ (Health Survey)</h2>
    
    <form id="healthForm">
        <div>
            <label for="age">อายุ (ปี):</label>
            <input type="number" id="age" name="age" min="1" max="120">
            <div id="ageError"></div>
        </div>

        <div>
            <label>เพศ:</label>
            <div>
                <div>
                    <input type="radio" id="male" name="gender" value="male">
                    <label for="male">ชาย</label>
                </div>
                <div>
                    <input type="radio" id="female" name="gender" value="female">
                    <label for="female">หญิง</label>
                </div>
            </div>
        </div>

        <div>
            <label for="weight">น้ำหนัก (กิโลกรัม):</label>
            <input type="number" id="weight" name="weight" step="0.1" min="1">
            <div id="weightError"></div>
        </div>

        <div>
            <label for="height">ส่วนสูง (เซนติเมตร):</label>
            <input type="number" id="height" name="height" step="0.1" min="1">
            <div id="heightError"></div>
        </div>

        <div>
            <div>
                <input type="checkbox" id="diseaseHistory" name="diseaseHistory">
                <label for="diseaseHistory">มีโรคประจำตัว</label>
            </div>
        </div>

        <div id="diseaseDetails" style="display: none;">
            <label for="diseaseText">โรคประจำตัว (รายละเอียด):</label>
            <textarea id="diseaseText" name="diseaseText" placeholder="กรุณาระบุโรคประจำตัว"></textarea>
        </div>

        <button type="submit">ส่งข้อมูล</button>
    </form>

    <div id="result" style="display: none;">
        <h3>ผลการประมวลผล:</h3>
        <div id="resultContent"></div>
    </div>
    <a href="/index3.html">
    <button>
      หน้าถัดไป
    </button>
    </a>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const diseaseCheckbox = document.getElementById('diseaseHistory');
            const diseaseDetails = document.getElementById('diseaseDetails');
            const form = document.getElementById('healthForm');

            // Show/hide disease details textarea based on checkbox
            diseaseCheckbox.addEventListener('change', function() {
                if (this.checked) {
                    diseaseDetails.style.display = 'block';
                } else {
                    diseaseDetails.style.display = 'none';
                    document.getElementById('diseaseText').value = '';
                }
            });

            // Form validation and submission
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Clear previous errors
                clearErrors();
                
                // Get form values
                const age = parseInt(document.getElementById('age').value);
                const gender = document.querySelector('input[name="gender"]:checked');
                const weight = parseFloat(document.getElementById('weight').value);
                const height = parseFloat(document.getElementById('height').value);
                const hasDiseaseHistory = document.getElementById('diseaseHistory').checked;
                const diseaseText = document.getElementById('diseaseText').value.trim();
                
                let isValid = true;
                
                // Validation
                if (!age || age < 15 || age > 60) {
                    showError('ageError', 'อายุต้องอยู่ระหว่าง 15-60 ปี');
                    isValid = false;
                }
                
                if (!gender) {
                    alert('กรุณาเลือกเพศ');
                    isValid = false;
                }
                
                if (!weight || weight <= 0) {
                    showError('weightError', 'กรุณาใส่น้ำหนักที่ถูกต้อง');
                    isValid = false;
                }
                
                if (!height || height <= 0) {
                    showError('heightError', 'กรุณาใส่ส่วนสูงที่ถูกต้อง');
                    isValid = false;
                }
                
                if (hasDiseaseHistory && !diseaseText) {
                    alert('กรุณาระบุรายละเอียดโรคประจำตัว');
                    isValid = false;
                }
                
                if (isValid) {
                    // Calculate BMI
                    const heightInMeters = height / 100;
                    const bmi = weight / (heightInMeters * heightInMeters);
                    
                    // Display BMI category
                    let bmiCategory = '';
                    if (bmi < 18.5) {
                        bmiCategory = 'น้ำหนักน้อย';
                    } else if (bmi < 25) {
                        bmiCategory = 'น้ำหนักปกติ';
                    } else if (bmi < 30) {
                        bmiCategory = 'น้ำหนักเกิน';
                    } else {
                        bmiCategory = 'อ้วน';
                    }
                    
                    // Show results
                    const resultContent = document.getElementById('resultContent');
                    resultContent.innerHTML = `
                        <p><strong>อายุ:</strong> ${age} ปี</p>
                        <p><strong>เพศ:</strong> ${gender.value === 'male' ? 'ชาย' : 'หญิง'}</p>
                        <p><strong>น้ำหนัก:</strong> ${weight} กก.</p>
                        <p><strong>ส่วนสูง:</strong> ${height} ซม.</p>
                        <p><strong>BMI:</strong> ${bmi.toFixed(2)} (${bmiCategory})</p>
                        <p><strong>โรคประจำตัว:</strong> ${hasDiseaseHistory ? 'มี - ' + diseaseText : 'ไม่มี'}</p>
                    `;
                    
                    document.getElementById('result').style.display = 'block';
                }
            });
            
            function showError(elementId, message) {
                const errorElement = document.getElementById(elementId);
                errorElement.textContent = message;
                errorElement.style.color = 'red';
            }
            
            function clearErrors() {
                const errorElements = document.querySelectorAll('#ageError, #weightError, #heightError');
                errorElements.forEach(element => {
                    element.textContent = '';
                });
            }
        });
    </script>
</body>
</html>